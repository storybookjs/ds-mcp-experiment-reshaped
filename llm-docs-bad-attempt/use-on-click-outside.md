# useOnClickOutside Hook

## Overview
The useOnClickOutside hook detects clicks outside of a specified element, commonly used for closing dropdowns, modals, tooltips, and other overlay components when users click elsewhere.

## Key Features
- Click outside detection
- Multiple element support
- Event delegation optimization
- Touch event support
- Escape key integration
- Performance optimized

## Hook Interface
```typescript
function useOnClickOutside(\n  refs: React.RefObject<HTMLElement> | React.RefObject<HTMLElement>[],\n  handler: (event: MouseEvent | TouchEvent) => void,\n  enabled?: boolean\n): void;\n```\n\n## Usage Examples\n\n### Basic Dropdown Menu\n```typescript\nimport { useOnClickOutside, Button, Text, View, Card } from 'reshaped';\nimport { useState, useRef } from 'react';\n\nfunction DropdownMenu() {\n  const [isOpen, setIsOpen] = useState(false);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n  \n  useOnClickOutside(dropdownRef, () => {\n    setIsOpen(false);\n  }, isOpen);\n  \n  const menuItems = [\n    { id: '1', label: 'Profile Settings', action: () => console.log('Profile') },\n    { id: '2', label: 'Account Settings', action: () => console.log('Account') },\n    { id: '3', label: 'Preferences', action: () => console.log('Preferences') },\n    { id: '4', label: 'Sign Out', action: () => console.log('Sign Out') }\n  ];\n  \n  return (\n    <View style={{ position: 'relative' }}>\n      <Button \n        onClick={() => setIsOpen(!isOpen)}\n        variant=\"outline\"\n      >\n        Menu {isOpen ? '▼' : '▶'}\n      </Button>\n      \n      {isOpen && (\n        <div\n          ref={dropdownRef}\n          style={{\n            position: 'absolute',\n            top: '100%',\n            left: 0,\n            zIndex: 1000,\n            marginTop: '4px',\n            minWidth: '200px',\n            backgroundColor: 'var(--rs-color-background-elevation-base)',\n            border: '1px solid var(--rs-color-border-neutral-faded)',\n            borderRadius: '8px',\n            boxShadow: '0 4px 12px rgba(0,0,0,0.1)'\n          }}\n        >\n          <View gap={1} padding={2}>\n            {menuItems.map(item => (\n              <button\n                key={item.id}\n                onClick={() => {\n                  item.action();\n                  setIsOpen(false);\n                }}\n                style={{\n                  width: '100%',\n                  padding: '8px 12px',\n                  border: 'none',\n                  borderRadius: '6px',\n                  backgroundColor: 'transparent',\n                  cursor: 'pointer',\n                  textAlign: 'left',\n                  transition: 'background-color 0.2s'\n                }}\n                onMouseEnter={(e) => {\n                  e.currentTarget.style.backgroundColor = 'var(--rs-color-background-neutral-faded)';\n                }}\n                onMouseLeave={(e) => {\n                  e.currentTarget.style.backgroundColor = 'transparent';\n                }}\n              >\n                <Text variant=\"body-3\">{item.label}</Text>\n              </button>\n            ))}\n          </View>\n        </div>\n      )}\n    </View>\n  );\n}\n```\n\n### Modal Dialog\n```typescript\nimport { useOnClickOutside, Button, Text, View, Card } from 'reshaped';\nimport { useState, useRef, useEffect } from 'react';\n\nfunction ModalDialog() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [allowClickOutside, setAllowClickOutside] = useState(true);\n  const modalRef = useRef<HTMLDivElement>(null);\n  const [formData, setFormData] = useState({ name: '', email: '' });\n  \n  // Close modal on click outside\n  useOnClickOutside(modalRef, () => {\n    if (allowClickOutside) {\n      setIsOpen(false);\n    }\n  }, isOpen);\n  \n  // Close on Escape key\n  useEffect(() => {\n    if (!isOpen) return;\n    \n    const handleEscape = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        setIsOpen(false);\n      }\n    };\n    \n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [isOpen]);\n  \n  const resetForm = () => {\n    setFormData({ name: '', email: '' });\n  };\n  \n  const handleSubmit = () => {\n    console.log('Form submitted:', formData);\n    setIsOpen(false);\n    resetForm();\n  };\n  \n  return (\n    <View gap={4}>\n      <Button onClick={() => setIsOpen(true)}>\n        Open Modal\n      </Button>\n      \n      {isOpen && (\n        <div\n          style={{\n            position: 'fixed',\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            backgroundColor: 'rgba(0, 0, 0, 0.5)',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            zIndex: 1000\n          }}\n        >\n          <Card \n            ref={modalRef}\n            padding={6}\n            style={{ \n              maxWidth: '400px',\n              width: '90%',\n              maxHeight: '80vh',\n              overflow: 'auto'\n            }}\n          >\n            <View gap={4}>\n              <View direction=\"row\" justify=\"space-between\" align=\"center\">\n                <Text variant=\"title-4\">Contact Information</Text>\n                <Button \n                  variant=\"ghost\" \n                  size=\"small\"\n                  onClick={() => setIsOpen(false)}\n                >\n                  ✕\n                </Button>\n              </View>\n              \n              <View gap={3}>\n                <View gap={1}>\n                  <Text variant=\"body-2\" weight=\"medium\">Name</Text>\n                  <input\n                    type=\"text\"\n                    value={formData.name}\n                    onChange={(e) => setFormData(prev => ({ ...prev, name: e.target.value }))}\n                    placeholder=\"Enter your name\"\n                    style={{\n                      width: '100%',\n                      padding: '8px 12px',\n                      border: '1px solid var(--rs-color-border-neutral-faded)',\n                      borderRadius: '6px'\n                    }}\n                  />\n                </View>\n                \n                <View gap={1}>\n                  <Text variant=\"body-2\" weight=\"medium\">Email</Text>\n                  <input\n                    type=\"email\"\n                    value={formData.email}\n                    onChange={(e) => setFormData(prev => ({ ...prev, email: e.target.value }))}\n                    placeholder=\"Enter your email\"\n                    style={{\n                      width: '100%',\n                      padding: '8px 12px',\n                      border: '1px solid var(--rs-color-border-neutral-faded)',\n                      borderRadius: '6px'\n                    }}\n                  />\n                </View>\n              </View>\n              \n              <View gap={3}>\n                <label style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n                  <input\n                    type=\"checkbox\"\n                    checked={allowClickOutside}\n                    onChange={(e) => setAllowClickOutside(e.target.checked)}\n                  />\n                  <Text variant=\"body-3\">Allow click outside to close</Text>\n                </label>\n                \n                <Text variant=\"body-3\" color=\"neutral-faded\">\n                  {allowClickOutside \n                    ? 'Click outside the modal or press Escape to close.' \n                    : 'Use the X button or Escape key to close.'\n                  }\n                </Text>\n              </View>\n              \n              <View direction=\"row\" gap={2} justify=\"flex-end\">\n                <Button \n                  variant=\"outline\" \n                  onClick={() => {\n                    setIsOpen(false);\n                    resetForm();\n                  }}\n                >\n                  Cancel\n                </Button>\n                <Button \n                  onClick={handleSubmit}\n                  disabled={!formData.name || !formData.email}\n                >\n                  Submit\n                </Button>\n              </View>\n            </View>\n          </Card>\n        </div>\n      )}\n    </View>\n  );\n}\n```\n\n### Multiple Element Detection\n```typescript\nimport { useOnClickOutside, Button, Text, View, Card } from 'reshaped';\nimport { useState, useRef } from 'react';\n\nfunction MultiElementDetection() {\n  const [activePopover, setActivePopover] = useState<string | null>(null);\n  const popover1Ref = useRef<HTMLDivElement>(null);\n  const popover2Ref = useRef<HTMLDivElement>(null);\n  const popover3Ref = useRef<HTMLDivElement>(null);\n  \n  // Close any open popover when clicking outside all of them\n  useOnClickOutside(\n    [popover1Ref, popover2Ref, popover3Ref],\n    () => setActivePopover(null),\n    !!activePopover\n  );\n  \n  const togglePopover = (id: string) => {\n    setActivePopover(activePopover === id ? null : id);\n  };\n  \n  const PopoverContent = ({ id, title, content }: { id: string; title: string; content: string }) => {\n    const isActive = activePopover === id;\n    const ref = id === 'popover1' ? popover1Ref : \n               id === 'popover2' ? popover2Ref : popover3Ref;\n    \n    return (\n      <View style={{ position: 'relative' }}>\n        <Button \n          onClick={() => togglePopover(id)}\n          variant={isActive ? 'solid' : 'outline'}\n          size=\"small\"\n        >\n          {title}\n        </Button>\n        \n        {isActive && (\n          <Card\n            ref={ref}\n            padding={4}\n            style={{\n              position: 'absolute',\n              top: '100%',\n              left: 0,\n              zIndex: 1000,\n              marginTop: '4px',\n              minWidth: '250px',\n              boxShadow: '0 4px 12px rgba(0,0,0,0.15)'\n            }}\n          >\n            <View gap={2}>\n              <Text variant=\"title-6\">{title}</Text>\n              <Text variant=\"body-3\">{content}</Text>\n              <Button \n                size=\"small\" \n                onClick={() => setActivePopover(null)}\n              >\n                Close\n              </Button>\n            </View>\n          </Card>\n        )}\n      </View>\n    );\n  };\n  \n  return (\n    <Card padding={6}>\n      <View gap={4}>\n        <Text variant=\"title-5\">Multiple Element Detection</Text>\n        \n        <Text variant=\"body-3\" color=\"neutral-faded\">\n          Click any button to open a popover. Click outside any open popover to close it.\n          Only one popover can be open at a time.\n        </Text>\n        \n        <View direction=\"row\" gap={4} wrap>\n          <PopoverContent \n            id=\"popover1\"\n            title=\"Features\"\n            content=\"This popover shows product features. It will close when you click outside of it or open another popover.\"\n          />\n          \n          <PopoverContent \n            id=\"popover2\"\n            title=\"Pricing\"\n            content=\"Here you can find information about our pricing plans and subscription options.\"\n          />\n          \n          <PopoverContent \n            id=\"popover3\"\n            title=\"Support\"\n            content=\"Need help? Contact our support team through various channels including email, chat, and phone.\"\n          />\n        </View>\n        \n        <Text variant=\"body-3\" color=\"neutral-faded\">\n          Active popover: {activePopover || 'None'}\n        </Text>\n      </View>\n    </Card>\n  );\n}\n```\n\n### Search Autocomplete\n```typescript\nimport { useOnClickOutside, Text, View, Card, Button } from 'reshaped';\nimport { useState, useRef, useMemo } from 'react';\n\nfunction SearchAutocomplete() {\n  const [query, setQuery] = useState('');\n  const [isOpen, setIsOpen] = useState(false);\n  const [selectedIndex, setSelectedIndex] = useState(-1);\n  const autocompleteRef = useRef<HTMLDivElement>(null);\n  \n  const suggestions = useMemo(() => {\n    const allSuggestions = [\n      'React Hooks', 'React Router', 'React Context',\n      'JavaScript Arrays', 'JavaScript Objects', 'JavaScript Functions',\n      'TypeScript Types', 'TypeScript Interfaces', 'TypeScript Generics',\n      'CSS Grid', 'CSS Flexbox', 'CSS Animation',\n      'HTML Forms', 'HTML Accessibility', 'HTML Semantic Elements'\n    ];\n    \n    if (!query.trim()) return [];\n    \n    return allSuggestions\n      .filter(item => \n        item.toLowerCase().includes(query.toLowerCase())\n      )\n      .slice(0, 6);\n  }, [query]);\n  \n  useOnClickOutside(autocompleteRef, () => {\n    setIsOpen(false);\n    setSelectedIndex(-1);\n  }, isOpen);\n  \n  const handleInputChange = (value: string) => {\n    setQuery(value);\n    setIsOpen(value.length > 0);\n    setSelectedIndex(-1);\n  };\n  \n  const handleSuggestionClick = (suggestion: string) => {\n    setQuery(suggestion);\n    setIsOpen(false);\n    setSelectedIndex(-1);\n  };\n  \n  const handleKeyDown = (event: React.KeyboardEvent) => {\n    if (!isOpen || suggestions.length === 0) return;\n    \n    switch (event.key) {\n      case 'ArrowDown':\n        event.preventDefault();\n        setSelectedIndex(prev => \n          prev < suggestions.length - 1 ? prev + 1 : 0\n        );\n        break;\n      case 'ArrowUp':\n        event.preventDefault();\n        setSelectedIndex(prev => \n          prev > 0 ? prev - 1 : suggestions.length - 1\n        );\n        break;\n      case 'Enter':\n        event.preventDefault();\n        if (selectedIndex >= 0) {\n          handleSuggestionClick(suggestions[selectedIndex]);\n        }\n        break;\n      case 'Escape':\n        setIsOpen(false);\n        setSelectedIndex(-1);\n        break;\n    }\n  };\n  \n  return (\n    <Card padding={6}>\n      <View gap={4}>\n        <Text variant=\"title-5\">Search Autocomplete</Text>\n        \n        <View style={{ position: 'relative' }} ref={autocompleteRef}>\n          <input\n            type=\"text\"\n            value={query}\n            onChange={(e) => handleInputChange(e.target.value)}\n            onKeyDown={handleKeyDown}\n            onFocus={() => query.length > 0 && setIsOpen(true)}\n            placeholder=\"Search for topics...\"\n            style={{\n              width: '100%',\n              padding: '12px',\n              border: '1px solid var(--rs-color-border-neutral-faded)',\n              borderRadius: '8px',\n              fontSize: '16px'\n            }}\n          />\n          \n          {isOpen && suggestions.length > 0 && (\n            <div\n              style={{\n                position: 'absolute',\n                top: '100%',\n                left: 0,\n                right: 0,\n                zIndex: 1000,\n                marginTop: '4px',\n                backgroundColor: 'var(--rs-color-background-elevation-base)',\n                border: '1px solid var(--rs-color-border-neutral-faded)',\n                borderRadius: '8px',\n                boxShadow: '0 4px 12px rgba(0,0,0,0.1)',\n                maxHeight: '300px',\n                overflow: 'auto'\n              }}\n            >\n              {suggestions.map((suggestion, index) => (\n                <button\n                  key={suggestion}\n                  onClick={() => handleSuggestionClick(suggestion)}\n                  style={{\n                    width: '100%',\n                    padding: '12px',\n                    border: 'none',\n                    backgroundColor: index === selectedIndex \n                      ? 'var(--rs-color-background-primary-faded)' \n                      : 'transparent',\n                    cursor: 'pointer',\n                    textAlign: 'left',\n                    borderRadius: index === 0 ? '8px 8px 0 0' : \n                                 index === suggestions.length - 1 ? '0 0 8px 8px' : '0'\n                  }}\n                  onMouseEnter={() => setSelectedIndex(index)}\n                >\n                  <Text variant=\"body-3\">{suggestion}</Text>\n                </button>\n              ))}\n            </div>\n          )}\n        </View>\n        \n        <View gap={2}>\n          <Text variant=\"body-3\">\n            Selected: <Text as=\"span\" weight=\"medium\">{query || 'None'}</Text>\n          </Text>\n          \n          <Text variant=\"body-3\" color=\"neutral-faded\">\n            Type to search, use arrow keys to navigate, Enter to select, \n            or click outside to close suggestions.\n          </Text>\n        </View>\n        \n        <View direction=\"row\" gap={2}>\n          <Button \n            size=\"small\" \n            onClick={() => handleInputChange('')}\n            variant=\"outline\"\n          >\n            Clear\n          </Button>\n          <Button \n            size=\"small\" \n            onClick={() => handleInputChange('React')}\n            variant=\"ghost\"\n          >\n            Try \"React\"\n          </Button>\n        </View>\n      </View>\n    </Card>\n  );\n}\n```\n\n## Hook Configuration\n\n### Single Element\n```typescript\nconst elementRef = useRef<HTMLDivElement>(null);\nuseOnClickOutside(elementRef, () => {\n  // Handle click outside\n});\n```\n\n### Multiple Elements\n```typescript\nconst refs = [ref1, ref2, ref3];\nuseOnClickOutside(refs, () => {\n  // Handle click outside any element\n});\n```\n\n### Conditional Activation\n```typescript\nuseOnClickOutside(ref, handler, isActive);\n```\n\n## Event Handling\n\n### Supported Events\n- **mousedown**: Primary click detection\n- **touchstart**: Touch device support\n- **focusin**: Focus-based detection (optional)\n\n### Event Delegation\n- Uses document-level listeners for performance\n- Automatic cleanup on unmount\n- Efficient handling of multiple instances\n\n## Best Practices\n- Enable only when component is open\n- Combine with Escape key handling\n- Use with proper focus management\n- Consider accessibility implications\n- Test on touch devices\n\n## Related Hooks\n- **useKeyboardMode**: Keyboard navigation detection\n- **useHotkeys**: Keyboard shortcut handling\n- **useScrollLock**: Scroll management for overlays"